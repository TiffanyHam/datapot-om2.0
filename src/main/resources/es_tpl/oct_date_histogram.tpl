{  "size": 0,   "query": {  	"bool":{  		"must":[  		{  			"range": {		      "timestamp": {		        "gte": ${start?c},		        "lte": ${end?c}		      }		    }  		},  		{          "term": {            "protocol": {              "value": "conn"            }          }        }  		<#if ipsrc!="">,	     {          "term": {            "ip_src_addr": {              "value": "${ipsrc}"            }          }        }        </#if>       <#if ipdst!="">,	     {          "term": {            "ip_dst_addr": {              "value": "${ipdst}"            }          }        }        </#if>  		]  	}  },   "aggs": {    "octs":{      "date_histogram": {        "field": "timestamp",        "interval": ${interval?c},        "min_doc_count": 0,        "format": "MM/dd HH:mm",        "time_zone":"+08:00",         "extended_bounds" : {                  "min":${start?c},                  "max":${end?c}                           }      },     "aggs": {          "up":{            "max": {              "field": "orig_bytes"            }          },          "down":{            "max": {              "field": "resp_ip_bytes"            }          }        }    }  }}